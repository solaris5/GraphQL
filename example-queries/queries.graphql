# 1 Query: returns the complete component graph
query firstQuery{
 allDependencies{
  nodes{
  info:componentByDescendantId{
    id
    name
    license
    dependencies:dependenciesByAncestorId{
      nodes{dependencies:componentByDescendantId{
      id
      name
      license
      }}
    }
    
  }
  }
}
}

# 2 Query: returns component with id= 3 and all of its dependencies
query secondeQuery{
  componentById(id:3){
     name
     dependencies:
      dependenciesByAncestorId {
        totalCount
      nodes{
      dependencies: componentByDescendantId{
            name
          }
        }
      
     }
  }
}
  
# 3 CRUD-Operation create
# Create component with id 11 and name "Comp Q"
mutation thirdQuery{
  createComponent(input:{component:{
  id:11,
  name:"Comp Q",license:"MIT",version:"1.0.0",package:"org.q"
}}){component{
    id
    name
    license
    version
    package
}}
  
 
createDependency(input:{dependency:{
  ancestorId:8,
  descendantId:11,
  depth:3
  linking:"Comp H-Comp Q"
}}){dependency{
  ancestorId
  descendantId
  depth
  linking
  
}}

createDependency(input:{dependency:{
  ancestorId:1,
  descendantId:11,
  depth:4
  linking:"Comp A-Comp Q"
}}){dependency{
  ancestorId
  descendantId
  depth
  linking
  
}}
}

# test thirdQuery
query resultCreate{
  componentById(id:11){
    name
    license
    package
    version
     dependencies1:dependenciesByAncestorId {
        totalCount
      nodes{
      dependencies: componentByDescendantId{
            name
          }
        }
      
      }
    dependencies2:dependenciesByDescendantId{
      totalCount
      nodes{
        componentByAncestorId{
          name
         license
         package
         version
        }
      }
    }
 
}
}

# Update-Operation: mutate component with id=11. Change the components name from 'Comp Q' to 'Comp X'
  mutation fourQuery{
  updateDependencyByAncestorIdAndDescendantId(
    input:{
    ancestorId:8
    dependencyPatch:{
      ancestorId:10
      descendantId:11
      depth:4
      linking:"CompK-CompQ"
    }
    
    }){
    dependency{
      componentByDescendantId{
        id
       name
      
      }}
  }
}

<<<<<<< HEAD
//delet id =11 ,mit der Name = Comp X
// um die component zu loeschen, sollte in der Dependency-Tablle , die pfad descendant_id =11 lÃ¶schen
//1. zuerst die Pfad (8,11),(1,11) in der Dependency-Tabelle delete(wegen ancestorId, descendant_id als forgin key references on component_id)
//2. dann id =11 in der Component-Tabelle delelte

=======
# Delete component with id =11 (Comp X)
# Before the component can be deleted all of its dependencies in the dependency table have to be deleted first.
>>>>>>> 9afccff5657267631bb606683d528f3be371904e
mutation MyMutation {
  
  deleteDependencyByAncestorIdAndDescendantId(input: {ancestorId:8, descendantId: 11}) {
    componentByDescendantId {
      id
      license
      name
    }
  }
}

mutation MyMutation {
  
  deleteDependencyByAncestorIdAndDescendantId(input: {ancestorId:1, descendantId: 11}) {
    componentByDescendantId {
      id
      license
      name
    }
  }
}

<<<<<<< HEAD

=======
>>>>>>> 9afccff5657267631bb606683d528f3be371904e
mutation delete {
  deleteComponentById (input:{id:11}){
    component{id name}
  }
}

<<<<<<< HEAD
//testen original componente Graph
=======
# test original component graph
>>>>>>> 9afccff5657267631bb606683d528f3be371904e
query original {
  allComponents {
    nodes {
      id
      license
      name
    }
  }
<<<<<<< HEAD
}
=======
}
>>>>>>> 9afccff5657267631bb606683d528f3be371904e
